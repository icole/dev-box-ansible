---
- name: Install emacs
  package:
    name: emacs
    state: latest
  become: true

- name: Check for Cask installation
  stat: path=~/.cask
  register: p

- name: Install Cask
  shell: curl -fsSL https://raw.githubusercontent.com/cask/cask/master/go | python
  when: not p.stat.exists

- name: Remove old emacs config
  file:
    dest=~/.emacs.d
    state="absent"

- name: Copy emacs.d
  file:
    src={{ playbook_dir}}/roles/emacs/files/emacs.d
    dest=~/.emacs.d
    state="link"

- name: Cask install dependencies
  shell: ~/.cask/bin/cask install
  args:
    chdir: ~/.emacs.d
